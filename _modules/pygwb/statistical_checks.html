<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygwb.statistical_checks &mdash; pygwb 1.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=0264ad83"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../_static/tabs.js?v=3030b3cb"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/pygwb_logo_plasma_cropped.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About <code class="docutils literal notranslate"><span class="pre">pygwb</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demos.html">Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arxiv.org/pdf/2303.15696.pdf">pygwb paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing <code class="docutils literal notranslate"><span class="pre">pygwb</span></code></a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/a-renzini/pygwb">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/a-renzini/pygwb/issues/new">Submit an issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pygwb</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pygwb.statistical_checks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pygwb.statistical_checks</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The ``statistical_checks`` module performs various tests by plotting different quantities and saving these plots. </span>
<span class="sd">This allows the user to check for consistency with expected results. Concretely, the following tests and plots</span>
<span class="sd">can be generated: running point estimate, running sigma, (cumulative) point estimate integrand, real and imaginary </span>
<span class="sd">part of point estimate integrand, FFT of the point estimate integrand, (cumulative) sensitivity, evolution of omega </span>
<span class="sd">and sigma as a function of time, omega and sigma distribution, KS test, and a linear trend analysis of omega in time. </span>
<span class="sd">Furthermore, part of these plots compares the values of these quantities before and after the delta sigma cut.</span>

<span class="sd">For additional information on how to run the statistical checks, and interpret them, we refer the user to the dedicatedplot_</span>
<span class="sd">tutorials and demos, as well as the `pygwb paper &lt;https://arxiv.org/pdf/2303.15696.pdf&gt;`_.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="k">as</span> <span class="nn">mt</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.handlelength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>

<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern&#39;</span><span class="p">]})</span>
<span class="c1"># FIXME - changed to get workflow running</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>

<span class="kn">from</span> <span class="nn">pygwb.baseline</span> <span class="kn">import</span> <span class="n">Baseline</span>
<span class="kn">from</span> <span class="nn">pygwb.notch</span> <span class="kn">import</span> <span class="n">StochNotchList</span>
<span class="kn">from</span> <span class="nn">pygwb.parameters</span> <span class="kn">import</span> <span class="n">Parameters</span>
<span class="kn">from</span> <span class="nn">pygwb.util</span> <span class="kn">import</span> <span class="n">StatKS</span><span class="p">,</span> <span class="n">calc_bias</span><span class="p">,</span> <span class="n">effective_welch_averages</span><span class="p">,</span> <span class="n">get_window_tuple</span>


<div class="viewcode-block" id="StatisticalChecks"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks">[docs]</a><span class="k">class</span> <span class="nc">StatisticalChecks</span><span class="p">:</span>
<div class="viewcode-block" id="StatisticalChecks.__init__"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sliding_times_all</span><span class="p">,</span>
        <span class="n">sliding_omega_all</span><span class="p">,</span>
        <span class="n">sliding_sigmas_all</span><span class="p">,</span>
        <span class="n">naive_sigmas_all</span><span class="p">,</span>
        <span class="n">coherence_spectrum</span><span class="p">,</span>
        <span class="n">coherence_n_segs</span><span class="p">,</span>
        <span class="n">point_estimate_spectrum</span><span class="p">,</span>
        <span class="n">sigma_spectrum</span><span class="p">,</span>
        <span class="n">frequencies</span><span class="p">,</span>
        <span class="n">badGPSTimes</span><span class="p">,</span>
        <span class="n">delta_sigmas</span><span class="p">,</span>
        <span class="n">plot_dir</span><span class="p">,</span>
        <span class="n">baseline_name</span><span class="p">,</span>
        <span class="n">param_file</span><span class="p">,</span>
        <span class="n">frequency_mask</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">coherence_far</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">gates_ifo1</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">gates_ifo2</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">file_tag</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">legend_fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
        <span class="n">convention</span> <span class="o">=</span> <span class="s1">&#39;pygwb&#39;</span><span class="p">,</span>
        <span class="n">seaborn_palette</span> <span class="o">=</span> <span class="s1">&#39;tab10&#39;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiate a StatisticalChecks object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        sliding_times_all: ``array_like``</span>
<span class="sd">            Array of GPS times before the bad GPS times from the delta sigma cut are applied.</span>
<span class="sd">        sliding_omega_all: ``array_like``</span>
<span class="sd">            Array of sliding omegas before the bad GPS times from the delta sigma cut are applied.</span>
<span class="sd">        sliding_sigmas_all: ``array_like``</span>
<span class="sd">            Array of sliding sigmas before the bad GPS times from the delta sigma cut are applied.</span>
<span class="sd">        naive_sigmas_all: ``array_like``</span>
<span class="sd">            Array of naive sigmas before the bad GPS times from the delta sigma cut are applied.</span>
<span class="sd">        coherence_spectrum: ``array_like``</span>
<span class="sd">            Array containing a coherence spectrum. Each entry in this array corresponds to the 2-detector coherence spectrum evaluated at the corresponding frequency in the frequencies array.</span>
<span class="sd">        coherence_n_segs: ``int``</span>
<span class="sd">            Number of segments used for coherence calculation.</span>
<span class="sd">        point_estimate_spectrum: ``array_like``</span>
<span class="sd">            Array containing the point estimate spectrum. Each entry in this array corresponds to the point estimate spectrum evaluated at the corresponding frequency in the frequencies array.</span>
<span class="sd">        sigma_spectrum: ``array_like``</span>
<span class="sd">            Array containing the sigma spectrum. Each entry in this array corresponds to the sigma spectrum evaluated at the corresponding frequency in the frequencies array.</span>
<span class="sd">        frequencies: ``array_like``</span>
<span class="sd">            Array containing the frequencies.</span>
<span class="sd">        badGPStimes: ``array_like``</span>
<span class="sd">            Array of bad GPS times, i.e. times that do not pass the delta sigma cut.</span>
<span class="sd">        delta_sigmas: ``array_like``</span>
<span class="sd">            Array containing the value of delta sigma for all times in sliding_times_all.</span>
<span class="sd">        plot_dir: ``str``</span>
<span class="sd">            String with the path to which the output of the statistical checks (various plots) will be saved.</span>
<span class="sd">        baseline_name: ``str``</span>
<span class="sd">            Name of the baseline under consideration.</span>
<span class="sd">        param_file: ``str``</span>
<span class="sd">            String with path to the file containing the parameters that were used for the analysis run.</span>
<span class="sd">        frequency_mask: ``array_like``</span>
<span class="sd">            Boolean mask applied to the specrtra in broad-band analyses. </span>
<span class="sd">        coherence_far: ``float``</span>
<span class="sd">            Target false alarm rate for number of frequency bins in the coherence spectrum exceeding the coherence threshold.</span>
<span class="sd">        gates_ifo1/gates_ifo2: ``list``</span>
<span class="sd">            List of gates applied to interferometer 1/2.</span>
<span class="sd">        file_tag: ``str``</span>
<span class="sd">            Tag to be used in file naming convention.</span>
<span class="sd">        legend_fontsize: ``int``</span>
<span class="sd">            Font size for plot legends. Default is 16. All other fonts are scaled to this font.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">update_from_file</span><span class="p">(</span><span class="n">param_file</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span> <span class="o">=</span> <span class="n">sliding_times_all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">days_all</span> <span class="o">=</span> <span class="p">(</span><span class="n">sliding_times_all</span> <span class="o">-</span> <span class="n">sliding_times_all</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">86400.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span> <span class="o">=</span> <span class="n">sliding_omega_all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span> <span class="o">=</span> <span class="n">sliding_sigmas_all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">naive_sigmas_all</span> <span class="o">=</span> <span class="n">naive_sigmas_all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">badGPStimes</span> <span class="o">=</span> <span class="n">badGPSTimes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_all</span> <span class="o">=</span> <span class="n">delta_sigmas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span> <span class="o">=</span> <span class="n">gates_ifo1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span> <span class="o">=</span> <span class="n">gates_ifo2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span> <span class="o">=</span> <span class="n">frequencies</span>
        <span class="k">if</span> <span class="n">frequency_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span> <span class="o">=</span> <span class="n">frequency_mask</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span> <span class="o">=</span> <span class="n">coherence_spectrum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coherence_far</span> <span class="o">=</span> <span class="n">coherence_far</span>
        <span class="k">if</span> <span class="n">coherence_n_segs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># FFT length in seconds</span>
            <span class="n">fftlength</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="c1"># FFT number of samples</span>
            <span class="n">nFFT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fftlength</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">new_sample_rate</span><span class="p">)</span>

            <span class="c1"># Number of samples in a segment used for calculating PSD</span>
            <span class="n">nSamples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">segment_duration</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">new_sample_rate</span><span class="p">)</span>
            
            <span class="n">window_tuple</span> <span class="o">=</span> <span class="n">get_window_tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">window_fft_dict_welch</span><span class="p">)</span>

            <span class="c1"># Total number of samples included in the all coherence segments combined. This is only approximate</span>
            <span class="c1"># since the coherences are combined across several discrete science segments. A more accurate count</span>
            <span class="c1"># could be obtained by saving this quantity for each science segment.</span>
            <span class="n">N_tot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nSamples</span> <span class="o">+</span> <span class="p">(</span><span class="n">coherence_n_segs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">overlap_factor</span><span class="p">)</span><span class="o">*</span><span class="n">nSamples</span><span class="p">)</span>

            <span class="c1"># Total number of effective segments - need to carefully check how many independent segments</span>
            <span class="c1"># there should be.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span> <span class="o">=</span> <span class="n">effective_welch_averages</span><span class="p">(</span><span class="n">N_tot</span><span class="p">,</span> <span class="n">nFFT</span><span class="p">,</span> <span class="n">window_tuple</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">overlap_factor_welch</span><span class="p">)</span>
            
            <span class="c1"># The old method, gives a slightly larger number of segments</span>
            <span class="c1"># self.n_segs = coherence_n_segs*(1.-self.params.overlap_factor)</span>
            <span class="c1">#     * int(np.floor(self.params.segment_duration/(fftlength*(1.-self.params.overlap_factor_welch)))-1)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">coarse_grain_csd</span><span class="p">:</span>
                <span class="c1"># Note: this breaks down when self.params.segment_duration/fftlength &lt; 3</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span> <span class="o">=</span> <span class="n">coherence_n_segs</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">overlap_factor</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">segment_duration</span><span class="o">/</span><span class="p">(</span><span class="n">fftlength</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_segs_statement</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;The number of segments is&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span><span class="si">}</span><span class="s2">.&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span> <span class="o">=</span> <span class="n">sigma_spectrum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span> <span class="o">=</span> <span class="n">point_estimate_spectrum</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span> <span class="o">=</span> <span class="n">baseline_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">segment_duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">frequency_resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_sample_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">new_sample_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltaT</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_sample_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">fref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">flow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fhigh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">fhigh</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">alpha</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">naive_sigma_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_KS</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data_after_dsc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dsc_percent</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_cut</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dsc_statement</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;The $\Delta\sigma$ cut removed&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dsc_percent</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">% of the data.&quot;</span>

        <span class="n">tot_tot_segs</span> <span class="o">=</span> <span class="p">((</span><span class="n">sliding_times_all</span> <span class="o">-</span> <span class="n">sliding_times_all</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">segment_duration</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">overlap_factor</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent_obs_segs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">naive_sigmas_all</span><span class="p">)</span><span class="o">/</span><span class="n">tot_tot_segs</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">running_pt_estimate</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">running_sigmas</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_running_quantities</span><span class="p">()</span>

        <span class="n">t0_gps</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;gps&#39;</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">t0_gps</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;utc&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">out_subfmt</span><span class="o">=</span><span class="s1">&#39;date_hm&#39;</span><span class="p">)</span>
        <span class="n">tf_gps</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;gps&#39;</span><span class="p">)</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">tf_gps</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;utc&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">out_subfmt</span><span class="o">=</span><span class="s1">&#39;date_hm&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot; $-$ &quot;</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">file_tag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span> <span class="o">=</span> <span class="n">file_tag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">t0_gps</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">tf_gps</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span> <span class="o">=</span> <span class="n">legend_fontsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span> <span class="o">=</span> <span class="n">legend_fontsize</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span> <span class="o">=</span> <span class="n">legend_fontsize</span> <span class="o">+</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span> <span class="o">=</span> <span class="n">legend_fontsize</span> <span class="o">-</span> <span class="mi">4</span>

        <span class="c1">## convention: stochmon</span>
        <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s1">&#39;stochmon&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="o">*</span><span class="mi">24</span> <span class="o">+</span> <span class="n">t0</span><span class="o">.</span><span class="n">ymdhms</span><span class="o">.</span><span class="n">hour</span> <span class="o">+</span> <span class="n">t0</span><span class="o">.</span><span class="n">ymdhms</span><span class="o">.</span><span class="n">minute</span><span class="o">/</span><span class="mi">60</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="o">*</span><span class="mi">24</span> <span class="o">+</span> <span class="n">t0</span><span class="o">.</span><span class="n">ymdhms</span><span class="o">.</span><span class="n">hour</span> <span class="o">+</span> <span class="n">t0</span><span class="o">.</span><span class="n">ymdhms</span><span class="o">.</span><span class="n">minute</span><span class="o">/</span><span class="mi">60</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Hours since </span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Days since </span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sea</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">seaborn_palette</span><span class="p">)</span></div>


<div class="viewcode-block" id="StatisticalChecks.get_data_after_dsc"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.get_data_after_dsc">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_after_dsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that returns the GPS times, the sliding omegas, the sliding sigmas, the naive sigmas, </span>
<span class="sd">        the delta sigmas and the sliding deviates after the bad GPS times from the delta sigma cut were applied. </span>
<span class="sd">        This function does not require any input parameters, as it accesses the data through the attributes of the class (e.g. `self.sliding_times_all`).</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>

<span class="sd">        sliding_times_cut: ``array_like``</span>
<span class="sd">            Array of GPS times after the bad GPS times were applied.</span>
<span class="sd">        days_cut: ``array_like``</span>
<span class="sd">            Array of days after the bad GPS times were applied.</span>
<span class="sd">        sliding_omega_cut: ``array_like``</span>
<span class="sd">            Array of the sliding omega values after the bad GPS times were applied.</span>
<span class="sd">        sliding_sigma_cut: ``array_like``</span>
<span class="sd">            Array of sliding sigmas after the bad GPS times were applied.</span>
<span class="sd">        naive_sigma_cut: ``array_like``</span>
<span class="sd">            Array of naive sigmas after the bad GPS times were applied.</span>
<span class="sd">        delta_sigma_cut: ``array_like``</span>
<span class="sd">            Array of the delta sigma values after the bad GPS times were applied.</span>
<span class="sd">        sliding_deviate_cut: ``array_like``</span>
<span class="sd">            Array of the deviates after the bad GPS times were applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bad_gps_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">badGPStimes</span>
        <span class="n">bad_gps_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_gps_times</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">])</span>

        <span class="n">bad_gps_mask</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">sliding_times_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">days_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sliding_omega_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sliding_sigma_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">naive_sigma_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">naive_sigmas_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">delta_sigma_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sliding_deviate_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">sliding_times_cut</span> <span class="o">=</span> <span class="n">sliding_times_cut</span><span class="p">[</span><span class="n">bad_gps_mask</span><span class="p">]</span>

        <span class="n">days_cut</span> <span class="o">=</span> <span class="n">days_cut</span><span class="p">[</span><span class="n">bad_gps_mask</span><span class="p">]</span>
        <span class="n">sliding_omega_cut</span> <span class="o">=</span> <span class="n">sliding_omega_cut</span><span class="p">[</span><span class="n">bad_gps_mask</span><span class="p">]</span>
        <span class="n">sliding_sigma_cut</span> <span class="o">=</span> <span class="n">sliding_sigma_cut</span><span class="p">[</span><span class="n">bad_gps_mask</span><span class="p">]</span>
        <span class="n">naive_sigma_cut</span> <span class="o">=</span> <span class="n">naive_sigma_cut</span><span class="p">[</span><span class="n">bad_gps_mask</span><span class="p">]</span>
        <span class="n">delta_sigma_cut</span> <span class="o">=</span> <span class="n">delta_sigma_cut</span><span class="p">[</span><span class="n">bad_gps_mask</span><span class="p">]</span>
        <span class="n">sliding_deviate_cut</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">sliding_omega_cut</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">/</span> <span class="n">sliding_sigma_cut</span>

        <span class="n">sliding_deviate_KS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">sliding_omega_cut</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">sliding_omega_cut</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">/</span> <span class="n">sliding_sigma_cut</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">sliding_times_cut</span><span class="p">,</span>
            <span class="n">days_cut</span><span class="p">,</span>
            <span class="n">sliding_omega_cut</span><span class="p">,</span>
            <span class="n">sliding_sigma_cut</span><span class="p">,</span>
            <span class="n">naive_sigma_cut</span><span class="p">,</span>
            <span class="n">delta_sigma_cut</span><span class="p">,</span>
            <span class="n">sliding_deviate_cut</span><span class="p">,</span>
            <span class="n">sliding_deviate_KS</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="StatisticalChecks.compute_running_quantities"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.compute_running_quantities">[docs]</a>    <span class="k">def</span> <span class="nf">compute_running_quantities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that computes the running point estimate and running sigmas from the sliding point estimate and sliding sigmas. </span>
<span class="sd">        This is done only for the values after the delta sigma cut. This method does not require any input parameters, as it accesses </span>
<span class="sd">        the data through the attributes of the class (e.g. `self.sliding_sigma_cut`).</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>

<span class="sd">        running_pt_estimate: ``array_like``</span>
<span class="sd">            Array containing the values of the running point estimate.</span>
<span class="sd">        running_sigmas: ``array_like``</span>
<span class="sd">            Array containing the values of the running sigmas.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">running_pt_estimate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">running_sigmas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_cut</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">([</span><span class="n">running_pt_estimate</span><span class="p">[</span><span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">running_sigmas</span><span class="p">[</span><span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="p">)</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">([</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">running_sigmas</span><span class="p">[</span><span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="p">)])</span>
            <span class="n">running_pt_estimate</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span>
            <span class="n">running_sigmas</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">denominator</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">running_pt_estimate</span><span class="p">,</span> <span class="n">running_sigmas</span></div>

<div class="viewcode-block" id="StatisticalChecks.compute_ifft_integrand"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.compute_ifft_integrand">[docs]</a>    <span class="k">def</span> <span class="nf">compute_ifft_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that computes the inverse Fourier transform of the point estimate integrand. </span>
<span class="sd">        This function does not require any input parameters, as it accesses the data through the </span>
<span class="sd">        attributes of the class (e.g. `self.point_estimate_integrand`).</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>

<span class="sd">        t_array: ``array_like``</span>
<span class="sd">            Array containing the time lag values (in seconds).</span>
<span class="sd">        omega_t: ``array_like``</span>
<span class="sd">            Array containing the</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        numpy.fft.fft</span>
<span class="sd">            More information `here &lt;https://numpy.org/doc/stable/reference/generated/numpy.fft.fft.html&gt;`_.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">numFreqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fhigh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span> <span class="o">*</span> <span class="n">numFreqs</span>

        <span class="n">fNyq</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaT</span><span class="p">)</span>

        <span class="n">numFreqs_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flow</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">f_pre</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numFreqs_pre</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">numFreqs_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">fNyq</span> <span class="o">-</span> <span class="n">fhigh</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span><span class="p">)</span>
        <span class="n">f_post</span> <span class="o">=</span> <span class="n">fhigh</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numFreqs_post</span><span class="p">)</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">f_pre</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">f_post</span><span class="p">))</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="n">f_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">fn</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">fp</span><span class="p">))</span>

        <span class="n">integrand_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numFreqs_pre</span><span class="p">))</span>
        <span class="n">integrand_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numFreqs_post</span><span class="p">))</span>
        <span class="n">integrand_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
            <span class="p">(</span><span class="n">integrand_pre</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span><span class="p">,</span> <span class="n">integrand_post</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">integrand_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">integrand_p</span><span class="p">))</span>

        <span class="n">integrand_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">integrand_p</span><span class="p">,</span> <span class="n">integrand_n</span><span class="p">))</span>

        <span class="n">fft_integrand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span> <span class="o">*</span> <span class="n">integrand_tot</span><span class="p">))</span>

        <span class="n">t_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaT</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaT</span>
        <span class="p">)</span>
        
        <span class="c1"># Take the real part to eliminate residual imaginary parts</span>
        <span class="n">omega_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">fft_integrand</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">t_array</span><span class="p">,</span> <span class="n">omega_t</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_running_point_estimate"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_running_point_estimate">[docs]</a>    <span class="k">def</span> <span class="nf">plot_running_point_estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the running point estimate. The plotted values are the </span>
<span class="sd">        ones after the delta sigma cut. This function does not require any input parameters, </span>
<span class="sd">        as it accesses the data through the attributes of the class (e.g. `self.days_cut`).</span>

<span class="sd">        Parameters</span>
<span class="sd">        =======</span>

<span class="sd">        ymin: ``array_like``</span>
<span class="sd">            Minimum value on the y-axis.</span>
<span class="sd">        ymax: ``array_like``</span>
<span class="sd">            Maximum value on the y-axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">running_pt_estimate</span><span class="p">,</span>
            <span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">running_pt_estimate</span> <span class="o">+</span> <span class="mf">1.65</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_sigmas</span><span class="p">,</span>
            <span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">running_pt_estimate</span> <span class="o">-</span> <span class="mf">1.65</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_sigmas</span><span class="p">,</span>
            <span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ymin</span> <span class="ow">and</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Point estimate $\pm 1.65 \sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;baseline time: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">percent_obs_segs</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Running point estimate in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-running_point_estimate.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_running_sigma"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_running_sigma">[docs]</a>    <span class="k">def</span> <span class="nf">plot_running_sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the running sigma. The plotted values are the ones after the delta sigma cut. </span>
<span class="sd">        This function does not require any input parameters, as it accesses the data through the attributes of the </span>
<span class="sd">        class (e.g. `self.days_cut`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_sigmas</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Running $\sigma$ &#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-running_sigma.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_IFFT_point_estimate_integrand"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_IFFT_point_estimate_integrand">[docs]</a>    <span class="k">def</span> <span class="nf">plot_IFFT_point_estimate_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the IFFT of the point estimate integrand. The IFFT of the point </span>
<span class="sd">        estimate integrand is computed using the method &quot;compute_ifft_integrand&quot;. This function does not </span>
<span class="sd">        require any input parameters, as it accesses the data through the attributes of the class (e.g. `self.point_estimate_integrand`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_array</span><span class="p">,</span> <span class="n">omega_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_ifft_integrand</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">omega_array</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Times and Omega arrays don&#39;t match in the IFFT. No plot could be generated. Investigation is highly recommended.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_array</span><span class="p">,</span> <span class="n">omega_array</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag (s)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Omega$ integrand IFFT&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Omega$ integrand IFFT&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-IFFT_point_estimate_integrand.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_SNR_spectrum"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_SNR_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_SNR_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the point estimate integrand. This function does not require any input parameters, </span>
<span class="sd">        as it accesses the data through the attributes of the class (e.g. `self.point_estimate_integrand`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span>
            <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span> 
        <span class="n">axs</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">],</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$|{\rm SNR}(f)|$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;|SNR| in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-abs_point_estimate_integrand.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_cumulative_SNR_spectrum"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_cumulative_SNR_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_cumulative_SNR_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the cumulative point estimate integrand. This function does not </span>
<span class="sd">        require any input parameters, as it accesses the data through the attributes of the class (e.g. `self.point_estimate_integrand`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pt_est_cumul</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">pt_est_cumul</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cum_pt_estimate</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pt_est_cumul</span><span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span>
        <span class="p">)</span>
        <span class="n">cum_pt_estimate</span> <span class="o">=</span> <span class="n">cum_pt_estimate</span> <span class="o">/</span> <span class="n">cum_pt_estimate</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cum_pt_estimate</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Cumulative $|{\rm SNR}(f)|$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cumulative SNR in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-cumulative_SNR_spectrum.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_real_SNR_spectrum"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_real_SNR_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_real_SNR_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the real part of the SNR spectrum. This function does not require </span>
<span class="sd">        any input parameters, as it accesses the data through the attributes of the class </span>
<span class="sd">        (e.g. `self.point_estimate_spectrum` and `self.sigma_spectrum`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span> 
        <span class="n">axs</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">],</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Re$({\rm SNR}(f))$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Real SNR in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-real_SNR_spectrum.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_imag_SNR_spectrum"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_imag_SNR_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_imag_SNR_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the imaginary part of the SNR spectrum. This function does not </span>
<span class="sd">        require any input parameters, as it accesses the data through the attributes of the class </span>
<span class="sd">        (e.g. `self.point_estimate_spectrum` and `self.sigma_spectrum`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span> 
        <span class="n">axs</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">],</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Im$({\rm SNR}(f))$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Imaginary SNR in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-imag_SNR_spectrum.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_sigma_spectrum"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_sigma_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_sigma_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the sigma spectrum. This function does not </span>
<span class="sd">        require any input parameters, as it accesses the data through the attributes </span>
<span class="sd">        of the class (e.g. `self.sigma_spectrum`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span> 
        <span class="n">axs</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">],</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma(f)$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Total $\sigma$ spectrum&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-sigma_spectrum.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.coherence_pdf"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.coherence_pdf">[docs]</a>    <span class="k">def</span> <span class="nf">coherence_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Theoretical pdf of coherences assuming Gaussian noise</span>

<span class="sd">        Parameters</span>

<span class="sd">        ==========</span>

<span class="sd">        gamma: ``array_like``</span>
<span class="sd">            Array of coherence values</span>

<span class="sd">        Returns</span>

<span class="sd">        ==========</span>

<span class="sd">        coherence_pdf: ``array_like``</span>
<span class="sd">            Value of PDF at each gamma</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="StatisticalChecks.coherence_pvalue"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.coherence_pvalue">[docs]</a>    <span class="k">def</span> <span class="nf">coherence_pvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Upper tail p-value of the given coherences assuming Gaussian noise</span>

<span class="sd">        Parameters</span>

<span class="sd">        ==========</span>

<span class="sd">        gamma: ``array_like``</span>
<span class="sd">            Array of coherence values</span>

<span class="sd">        Returns</span>

<span class="sd">        ==========</span>

<span class="sd">        coherence_pvalue: ``array_like``</span>
<span class="sd">            p-value of each gamma</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="StatisticalChecks.coherence_threshold"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.coherence_threshold">[docs]</a>    <span class="k">def</span> <span class="nf">coherence_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the coherence threshold corresponding to the given FAR.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coherence_far</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">threshold</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_coherence_spectrum"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_coherence_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_coherence_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fhigh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the coherence spectrum, if present. This function does not require any input parameters, as it accesses the data through the attributes of the class (e.g. `coherence_spectrum`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">flow</span> <span class="o">=</span> <span class="n">flow</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow</span>
        <span class="n">fhigh</span> <span class="o">=</span> <span class="n">fhigh</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">fhigh</span>

        <span class="n">threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_threshold</span><span class="p">()</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Plot a reference line representing the mean of the theoretical coherence</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span><span class="p">,</span><span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

        <span class="c1"># Plot a line representing the coherence threshold</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span><span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="n">fhigh</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">channel</span><span class="si">}</span><span class="s2">, threshold $\gamma = $</span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence ($\Delta f$ = &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span><span class="si">:</span><span class="s1">.5g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> Hz) in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-coherence_spectrum.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Plot a reference line representing the mean of the theoretical coherence</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span><span class="p">,</span><span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

        <span class="c1"># Plot a line representing the coherence threshold</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span><span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">channel</span><span class="si">}</span><span class="s2">, threshold $\gamma =$ </span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence ($\Delta f$ = &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span><span class="si">:</span><span class="s1">.5g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> Hz) in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-coherence_spectrum_zoom.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="StatisticalChecks.plot_hist_coherence"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_hist_coherence">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hist_coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">total_bins</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a histogram of the coherence distribution. The plot shows the data after the delta-sigma cut (bad GPS times) was applied. This function does not require any input parameters, as it accesses the data through the attributes of the class.</span>
<span class="sd">        Furthermore, it also saves a text file which contains the frequencies at which outliers of the coherence distribution were identified, i.e. spectral artefacts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">coherence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span>
        <span class="n">coherence_clipped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coherence</span><span class="p">))</span>
        <span class="c1"># For zoomed plots, coherence is clipped at 50 times the theoretical mean</span>
        <span class="n">clip_val</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">n_segs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coherence_clipped</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">clip_val</span><span class="p">:</span>
                <span class="n">coherence_clipped</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">clip_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coherence_clipped</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span>
        <span class="k">if</span> <span class="n">total_bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">total_bins</span> <span class="o">=</span> <span class="mi">250</span>

        <span class="c1"># Bins are chosen so that the highest coherence value is the centre of the last bin</span>
        <span class="n">upper_edge</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">coherence</span><span class="p">)</span><span class="o">*</span><span class="n">total_bins</span><span class="o">/</span><span class="p">(</span><span class="n">total_bins</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">bins</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_edge</span><span class="p">,</span> <span class="n">total_bins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">delta_coherence</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">upper_edge_clipped</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">coherence_clipped</span><span class="p">)</span><span class="o">*</span><span class="n">total_bins</span><span class="o">/</span><span class="p">(</span><span class="n">total_bins</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">bins_clipped</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_edge_clipped</span><span class="p">,</span> <span class="n">total_bins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">delta_coherence_clipped</span> <span class="o">=</span> <span class="n">bins_clipped</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bins_clipped</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Note that the number of frequencies should be equal to the total number of counts</span>
        <span class="c1"># for the un-notched coherences, but is different to the total number of counts</span>
        <span class="c1"># for notched coherences. Care may be needed when comparing predicted counts</span>
        <span class="c1"># with the notched coherence histogram.</span>
        <span class="n">n_frequencies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="n">frequencies</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">coherence_notched</span> <span class="o">=</span> <span class="n">coherence</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">]</span>
        <span class="n">coherence_notched_clipped</span> <span class="o">=</span> <span class="n">coherence_clipped</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">]</span>

        <span class="c1"># Coherence values aligned with bin centres up to twice the max value of the coherence</span>
        <span class="n">coherence_highres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">delta_coherence</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">upper_edge</span> <span class="o">+</span> <span class="n">delta_coherence</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">total_bins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Theoretical pdf of coherences assuming Gaussian noise</span>
        <span class="n">predicted_highres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_pdf</span><span class="p">(</span><span class="n">coherence_highres</span><span class="p">)</span>

        <span class="c1"># Threshold to give a false-alarm rate of FAR frequency bins per coherence spectrum</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_threshold</span><span class="p">()</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
   
        <span class="n">axs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">coherence</span><span class="p">,</span>
            <span class="n">bins</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Before notching&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">coherence_notched</span><span class="p">,</span>
            <span class="n">bins</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;After notching&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">coherence_highres</span><span class="p">,</span> 
            <span class="n">predicted_highres</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicted&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">threshold</span><span class="p">),</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Threshold ($</span><span class="se">\\</span><span class="s2">gamma = $</span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Probability distribution&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">max_coh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coherence</span><span class="p">,</span> <span class="n">threshold</span><span class="p">))</span>
        <span class="c1"># Go up to nearest 10th</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">max_coh</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">100.0</span><span class="o">/</span><span class="n">n_frequencies</span><span class="p">)),</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">predicted_highres</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence hist ($\Delta f$ = &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">resolution</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> Hz) in&quot;</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-histogram_coherence.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>      

        <span class="n">axs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">coherence_clipped</span><span class="p">,</span>
            <span class="n">bins_clipped</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Before notching&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">coherence_notched_clipped</span><span class="p">,</span>
            <span class="n">bins_clipped</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;After notching&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">coherence_highres</span><span class="p">,</span> 
            <span class="n">predicted_highres</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicted&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">threshold</span><span class="p">),</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Threshold ($</span><span class="se">\\</span><span class="s2">gamma = $</span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Probability distribution&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">max_coh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coherence_clipped</span><span class="p">,</span> <span class="n">threshold</span><span class="p">))</span>
        <span class="c1"># For zoomed plot, go up to nearest 100th</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">max_coh</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">100.0</span><span class="o">/</span><span class="n">n_frequencies</span><span class="p">)),</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">predicted_highres</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Coherence hist (zoomed) ($\Delta f$ = &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">resolution</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> Hz) in&quot;</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-histogram_coherence_zoom.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">outlier_coherence</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coherence</span><span class="p">)):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">outlier_coherence</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">n_frequencies</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">coherence_pvalue</span><span class="p">(</span><span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> In outlier_coherence, Frequency now is </span><span class="si">%f</span><span class="s1">, and coherence is </span><span class="si">%f</span><span class="s1">, which is out of the boundary 1, please check it&#39;</span>
                            <span class="o">%</span><span class="p">(</span><span class="n">frequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            <span class="p">)</span>
                    <span class="n">outlier_coherence_notched</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">frequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>

        <span class="n">outlier_coherence_notched</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coherence</span><span class="p">)):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">outlier_coherence_notched</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">n_frequencies</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">coherence_pvalue</span><span class="p">(</span><span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> In outlier_coherence_notched, Frequency now is </span><span class="si">%f</span><span class="s1">, and coherence is </span><span class="si">%f</span><span class="s1">, which is out of the boundary 1, please check it&#39;</span>
                            <span class="o">%</span><span class="p">(</span><span class="n">frequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            <span class="p">)</span>
                    <span class="n">outlier_coherence_notched</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">frequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;nan&#39;</span><span class="p">))</span>
        
        <span class="n">n_outlier</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">outlier_coherence</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-list_coherence_outlier.txt&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Bin </span><span class="se">\t</span><span class="s1">Frequency </span><span class="se">\t</span><span class="s1">Coherence </span><span class="se">\t</span><span class="s1">Expected counts above this coherence</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">outlier_coherence</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> The outliers below are already included in the applied version of the notch-list</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">outlier_coherence_notched</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tup</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="StatisticalChecks.plot_cumulative_sensitivity"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_cumulative_sensitivity">[docs]</a>    <span class="k">def</span> <span class="nf">plot_cumulative_sensitivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of the cumulative sensitivity. This function does not </span>
<span class="sd">        require any input parameters, as it accesses the data through the attributes of </span>
<span class="sd">        the class (e.g. `self.sigma_spectrum`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_estimate_spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">sigma_cumul</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_spectrum</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sigma_cumul</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">cumul_sens</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">sigma_cumul</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">)</span>
        <span class="n">cumul_sens</span> <span class="o">=</span> <span class="n">cumul_sens</span> <span class="o">/</span> <span class="n">cumul_sens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cumul_sens</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative sensitivity&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$1/\sigma^2$ &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-cumulative_sigma_spectrum.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_omega_sigma_in_time"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_omega_sigma_in_time">[docs]</a>    <span class="k">def</span> <span class="nf">plot_omega_sigma_in_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a panel plot with a scatter plot of :math:`\sigma` vs </span>
<span class="sd">        :math:`\Delta{\rm SNR}_i`, as well as the evolution of :math:`\Omega`, :math:`\sigma`, </span>
<span class="sd">        and :math:`(\Omega-\langle\Omega\rangle)/\sigma` as a function of the days since the </span>
<span class="sd">        start of the run. All plots show the data before and after the delta-sigma cut (bad GPS times) </span>
<span class="sd">        was applied. This function does not require any input parameters, as it accesses the data </span>
<span class="sd">        through the attributes of the class (e.g. `self.sliding_sigmas_all`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Omega$, $\sigma$, and&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; SNR variations in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2"> with/out &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\sigma$ cut&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_all</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Omega$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta{\rm SNR}_i$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_all</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;symlog&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-omega_sigma_time.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_hist_sigma_dsc"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_hist_sigma_dsc">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hist_sigma_dsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a panel plot with a histogram of :math:`|\Delta\sigma|/\sigma`, </span>
<span class="sd">        as well as a histogram of :math:`\sigma`. Both plots show the data before and after </span>
<span class="sd">        the delta-sigma cut (bad GPS times) was applied. This function does not require any </span>
<span class="sd">        input parameters, as it accesses the data through the attributes of the class (e.g. `self.delta_sigmas_all`).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta\sigma$ and $\sigma$ distributions in&quot;</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2"> with/out &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\sigma$ cut&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_all</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$|\Delta\sigma|/\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">minx1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">)</span>
            <span class="n">maxx1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minx1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">)</span>
            <span class="n">maxx1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">)</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="mi">50</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">minx1</span><span class="p">,</span> <span class="n">maxx1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">minx1</span><span class="p">,</span> <span class="n">maxx1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-histogram_sigma_dsc.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_scatter_sigma_dsc"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_scatter_sigma_dsc">[docs]</a>    <span class="k">def</span> <span class="nf">plot_scatter_sigma_dsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a scatter plot of :math:`|\Delta\sigma]/\sigma` vs :math:`\sigma`. </span>
<span class="sd">        The plot shows the data before and after the delta-sigma cut (bad GPS times) was applied. </span>
<span class="sd">        This function does not require any input parameters, as it accesses the data through the </span>
<span class="sd">        attributes of the class (e.g. `self.delta_sigmas_all`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

        <span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_all</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">naive_sigmas_all</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">naive_sigma_cut</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>

            <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$|\Delta\sigma|/\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;Data cut by $\Delta\sigma$ cut&quot;</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dsc_percent</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta\sigma$ distribution in&quot;</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2"> with/out &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\sigma$ cut&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-scatter_sigma_dsc.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_scatter_omega_sigma_dsc"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_scatter_omega_sigma_dsc">[docs]</a>    <span class="k">def</span> <span class="nf">plot_scatter_omega_sigma_dsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a panel plot with scatter plots of :math:`|\Delta\sigma|/\sigma` vs :math:`\Delta{\rm SNR}_i`, </span>
<span class="sd">        as well as :math:`\sigma` vs :math:`(\Omega-\langle\Omega\rangle)/\sigma`. All plots show the data before and after </span>
<span class="sd">        the delta-sigma cut (bad GPS times) was applied. This function does not require any input parameters, as it accesses </span>
<span class="sd">        the data through the attributes of the class (e.g. `self.delta_sigmas_all`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta$SNR spread&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2"> with/out &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\sigma$ cut&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">maxx0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_all</span><span class="p">)</span>
            <span class="n">maxx0</span> <span class="o">+=</span> <span class="n">maxx0</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">minx0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_all</span><span class="p">)</span>
            <span class="n">minx0</span> <span class="o">-=</span> <span class="n">minx0</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">maxy0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">)</span>
            <span class="n">maxy0</span> <span class="o">+=</span> <span class="n">maxy0</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">miny0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">)</span>
            <span class="n">miny0</span> <span class="o">-=</span> <span class="n">miny0</span> <span class="o">/</span> <span class="mf">10.0</span>

            <span class="n">maxx1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">)</span>
            <span class="n">maxx1</span> <span class="o">+=</span> <span class="n">maxx1</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">minx1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">)</span>
            <span class="n">minx1</span> <span class="o">-=</span> <span class="n">minx1</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">maxy1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">)</span>
            <span class="n">maxy1</span> <span class="o">+=</span> <span class="n">maxy1</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">miny1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">)</span>
            <span class="n">miny1</span> <span class="o">-=</span> <span class="n">miny1</span> <span class="o">/</span> <span class="mf">10.0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">maxx0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="p">)</span>
            <span class="n">maxx0</span> <span class="o">+=</span> <span class="n">maxx0</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">minx0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="p">)</span>
            <span class="n">minx0</span> <span class="o">-=</span> <span class="n">minx0</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">maxy0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">)</span>
            <span class="n">maxy0</span> <span class="o">+=</span> <span class="n">maxy0</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">miny0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">)</span>
            <span class="n">miny0</span> <span class="o">-=</span> <span class="n">miny0</span> <span class="o">/</span> <span class="mf">10.0</span>

            <span class="n">maxx1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">)</span>
            <span class="n">maxx1</span> <span class="o">+=</span> <span class="n">maxx1</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">minx1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">)</span>
            <span class="n">minx1</span> <span class="o">-=</span> <span class="n">minx1</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">maxy1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">)</span>
            <span class="n">maxy1</span> <span class="o">+=</span> <span class="n">maxy1</span> <span class="o">/</span> <span class="mf">10.0</span>
            <span class="n">miny1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">)</span>
            <span class="n">miny1</span> <span class="o">-=</span> <span class="n">miny1</span> <span class="o">/</span> <span class="mf">10.0</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_all</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$|\Delta\sigma|/\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta{\rm SNR}_i$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minx0</span><span class="p">,</span> <span class="n">maxx0</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">miny0</span><span class="p">,</span> <span class="n">maxy0</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigmas_all</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma/\sigma|$ outlier cut&quot;</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta{\rm SNR}_i$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minx1</span><span class="p">,</span> <span class="n">maxx1</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">miny1</span><span class="p">,</span> <span class="n">maxy1</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-scatter_omega_sigma_dsc.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_hist_omega_pre_post_dsc"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_hist_omega_pre_post_dsc">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hist_omega_pre_post_dsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a histogram of the :math:`\Delta{\rm SNR}_i` distribution. The plot </span>
<span class="sd">        shows the data before and after the delta-sigma cut (bad GPS times) was applied. This function</span>
<span class="sd">          does not require any input parameters, as it accesses the data through the attributes of the </span>
<span class="sd">          class (e.g. `self.sliding_deviate_all`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

        <span class="c1"># nan-safing the histograms for good measure...</span>
        <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">)],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">)])),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">202</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">axs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_all</span><span class="p">,</span>
            <span class="n">bins</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">,</span>
            <span class="n">bins</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta{\rm SNR}_i$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta$SNR distribution in&quot;</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2"> with/out &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\sigma$ cut&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-histogram_omega_dsc.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_KS_test"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_KS_test">[docs]</a>    <span class="k">def</span> <span class="nf">plot_KS_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a panel plot with results of the Kolmogorov-Smirnov test for Gaussianity. </span>
<span class="sd">        The cumulative distribution of the data (after the delta-sigma (bad GPS times) cut) is compared </span>
<span class="sd">        to the one of Gaussian data, where the bias factor for the sigmas is taken into account. This </span>
<span class="sd">        function does not require any input parameters, as it accesses the data through the attributes </span>
<span class="sd">        of the class (e.g. `self.sliding_deviate_cut`).</span>

<span class="sd">        Parameters</span>
<span class="sd">        =======</span>

<span class="sd">        bias_factor: ``float``, optional</span>
<span class="sd">            Bias factor to consider in the KS calculation. Defaults to None, in which case it </span>
<span class="sd">            computes the bias factor on the fly.</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        pygwb.util.calc_bias</span>

<span class="sd">        pygwb.util.StatKS</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">bias_factor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bias_factor</span> <span class="o">=</span> <span class="n">calc_bias</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_duration</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaT</span><span class="p">)</span>
        <span class="n">dof_scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mf">35.0</span><span class="p">)</span>
        <span class="n">lx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_cut</span><span class="p">)</span>

        <span class="n">sorted_deviates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_deviate_KS</span> <span class="o">/</span> <span class="n">bias_factor</span><span class="p">)</span>

        <span class="n">nanmask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sorted_deviates</span><span class="p">)</span>
        <span class="n">sorted_deviates_nansafe</span> <span class="o">=</span> <span class="n">sorted_deviates</span><span class="p">[</span><span class="n">nanmask</span><span class="p">]</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">bins_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sorted_deviates_nansafe</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="n">cdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>

        <span class="n">normal</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">normal_cdf</span> <span class="o">=</span> <span class="n">normal</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">bins_count</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="n">dks_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cdf</span> <span class="o">-</span> <span class="n">normal_cdf</span><span class="p">))</span>
        <span class="n">lx_eff</span> <span class="o">=</span> <span class="n">lx</span> <span class="o">*</span> <span class="n">dof_scale_factor</span>

        <span class="n">lam</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lx_eff</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.12</span> <span class="o">+</span> <span class="mf">0.11</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lx_eff</span><span class="p">))</span> <span class="o">*</span> <span class="n">dks_x</span>
        <span class="n">pval_KS</span> <span class="o">=</span> <span class="n">StatKS</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kolmogorov-Smirnov test in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins_count</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">cdf</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">bins_count</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">normal_cdf</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Erf with $\sigma$=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">bias_factor</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">bins_count</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="mf">0.8</span><span class="p">,</span>
            <span class="s2">&quot;KS-statistic: &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dks_x</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;p-value: &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pval_KS</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">bins_count</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">cdf</span> <span class="o">-</span> <span class="n">normal_cdf</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="s2">&quot;Maximum absolute difference: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dks_x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-KS_test.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_hist_sigma_squared"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_hist_sigma_squared">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hist_sigma_squared</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">total_bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label_number</span> <span class="o">=</span> <span class="mi">6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a histogram of :math:`\sigma^2/\langle\sigma^2\rangle`. The plot shows </span>
<span class="sd">        data after the delta-sigma (bad GPS times) cut. This function does not require any input parameters, </span>
<span class="sd">        as it accesses the data through the attributes of the class (e.g. self.sliding_sigma_cut).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_sigmas_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="n">values</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span> <span class="o">**</span> <span class="mi">2</span>
        
        <span class="n">values_clipped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values_clipped</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">max_val</span><span class="p">:</span>
                <span class="n">values_clipped</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values_clipped</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">values_clipped</span><span class="p">),</span> <span class="n">total_bins</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">values_clipped</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Data after $|\Delta\sigma|/\sigma$ outlier cut&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma^2/\langle\sigma^2\rangle$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        
        <span class="n">xticks_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">label_number</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xticks_tmp</span><span class="p">]</span>
        <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="s2">&quot;+&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">xticks_tmp</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relative variance in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-histogram_sigma_squared.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_omega_time_fit"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_omega_time_fit">[docs]</a>    <span class="k">def</span> <span class="nf">plot_omega_time_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of :math:`\Omega` as a function of time and fits the data to perform </span>
<span class="sd">        a linear trend analysis. The plot shows data after the delta-sigma (bad GPS times) cut. This function </span>
<span class="sd">        does not require any input parameters, as it accesses the data through the attributes of the </span>
<span class="sd">        class (e.g. self.sliding_omega_cut).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

        <span class="n">t_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">t_obs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_obs</span> <span class="o">+</span> <span class="n">b</span>

        <span class="n">nanmask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">)</span>
        <span class="n">sliding_omega_cut_nansafe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">[</span><span class="n">nanmask</span><span class="p">]</span>
        <span class="n">sliding_sigma_cut_nansafe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">[</span><span class="n">nanmask</span><span class="p">]</span>

        <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
            <span class="n">func</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="n">nanmask</span><span class="p">],</span>
            <span class="n">sliding_omega_cut_nansafe</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sliding_sigma_cut_nansafe</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_omega_cut</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Omega_i$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;Linear trend analysis: $\Omega(t) = C_1 (t-T_{\rm obs}/2) T_{\rm obs} + C_2 C_1 = $&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c1</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">C$_2$ = &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c2</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Time evolution of $\Omega$ &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-omega_time_fit.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="StatisticalChecks.plot_sigma_time_fit"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.plot_sigma_time_fit">[docs]</a>    <span class="k">def</span> <span class="nf">plot_sigma_time_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves a plot of :math:`\sigma` as a function of time and fits the data to perform </span>
<span class="sd">        a linear trend analysis. The plot shows data after the delta-sigma (bad GPS times) cut. This function </span>
<span class="sd">        does not require any input parameters, as it accesses the data through the attributes of the </span>
<span class="sd">        class (e.g. `self.sliding_sigma_cut`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

        <span class="n">t_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">t_obs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_obs</span> <span class="o">+</span> <span class="n">b</span>

        <span class="n">nanmask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">)</span>
        <span class="n">sliding_sigma_cut_nansafe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">[</span><span class="n">nanmask</span><span class="p">]</span>
        <span class="n">mean_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">)</span>

        <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
            <span class="n">func</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="n">nanmask</span><span class="p">],</span>
            <span class="n">sliding_sigma_cut_nansafe</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_sigma_cut</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma_i$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">days_cut</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">mean_sigma</span> <span class="o">-</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">mean_sigma</span><span class="p">,</span> <span class="n">mean_sigma</span> <span class="o">+</span> <span class="mf">2.2</span> <span class="o">*</span> <span class="n">mean_sigma</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;Linear trend analysis: $\sigma(t) = C_1 (t-T_{\rm obs}/2) T_{\rm obs} + C_2 C_1 = $&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c1</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">C$_2$ = &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c2</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_fontsize</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Time evolution of $\sigma$ &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-sigma_time_fit.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">plot_gates_in_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1_statement</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2_statement</span><span class="o">=</span><span class="kc">None</span>
            <span class="k">return</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1_statement</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_gated_time_ifo1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_gated_percent_ifo1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_gated_time_ifo1</span><span class="o">/</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
            <span class="n">gate_times_in_days_ifo1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">86400.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1_statement</span><span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Data gated out: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_gated_time_ifo1</span><span class="si">}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;Percentage: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_gated_percent_ifo1</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">%&quot;</span>
            <span class="n">gatefig1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gate_times_in_days_ifo1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IFO1:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1_statement</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">first_legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">gatefig1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.75</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">first_legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2_statement</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_gated_time_ifo2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_gated_percent_ifo2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_gated_time_ifo2</span><span class="o">/</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
            <span class="n">gate_times_in_days_ifo2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliding_times_all</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">86400.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2_statement</span><span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Data gated out: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_gated_time_ifo2</span><span class="si">}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;Percentage: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_gated_percent_ifo2</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">%&quot;</span>
            <span class="n">gatefig2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gate_times_in_days_ifo2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sea</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IFO2:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2_statement</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">gatefig2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Gate length (s)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes_labelsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gates applied to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title_fontsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">-gates_time.png&quot;</span><span class="p">,</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<div class="viewcode-block" id="StatisticalChecks.save_all_statements"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.save_all_statements">[docs]</a>    <span class="k">def</span> <span class="nf">save_all_statements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves all useful statements gathered throughout the checks to a json file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">statements</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">statements</span><span class="p">[</span><span class="s1">&#39;dsc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dsc_statement</span>
        <span class="n">statements</span><span class="p">[</span><span class="s1">&#39;gates_ifo1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo1_statement</span>
        <span class="n">statements</span><span class="p">[</span><span class="s1">&#39;gates_ifo2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gates_ifo2_statement</span>
        <span class="n">statements</span><span class="p">[</span><span class="s1">&#39;n_segs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_segs_statement</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;stats_statements.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">statements</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span></div>

<div class="viewcode-block" id="StatisticalChecks.generate_all_plots"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.StatisticalChecks.html#pygwb.statistical_checks.StatisticalChecks.generate_all_plots">[docs]</a>    <span class="k">def</span> <span class="nf">generate_all_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and saves all the statistical analysis plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_running_point_estimate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_running_sigma</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_IFFT_point_estimate_integrand</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_SNR_spectrum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_cumulative_SNR_spectrum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_real_SNR_spectrum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_imag_SNR_spectrum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_sigma_spectrum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_cumulative_sensitivity</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_omega_sigma_in_time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_hist_sigma_dsc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_scatter_sigma_dsc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_scatter_omega_sigma_dsc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_hist_omega_pre_post_dsc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_KS_test</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_hist_sigma_squared</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_omega_time_fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_sigma_time_fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_gates_in_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_spectrum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_coherence_spectrum</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_hist_coherence</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_all_statements</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="sortingFunction"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.sortingFunction.html#pygwb.statistical_checks.sortingFunction">[docs]</a><span class="k">def</span> <span class="nf">sortingFunction</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="run_statistical_checks_from_file"><a class="viewcode-back" href="../../api/pygwb.statistical_checks.run_statistical_checks_from_file.html#pygwb.statistical_checks.run_statistical_checks_from_file">[docs]</a><span class="k">def</span> <span class="nf">run_statistical_checks_from_file</span><span class="p">(</span>
    <span class="n">combine_file_path</span><span class="p">,</span> <span class="n">dsc_file_path</span><span class="p">,</span> <span class="n">plot_dir</span><span class="p">,</span> <span class="n">param_file</span><span class="p">,</span> <span class="n">coherence_far</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">coherence_file_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">file_tag</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s1">&#39;pygwb&#39;</span><span class="p">,</span> <span class="n">seaborn_palette</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to generate an instance of the statistical checks class from a set of files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    =======</span>

<span class="sd">    combine_file_path: ``str``</span>
<span class="sd">        Full path to the file containing the output of the pygwb.combine script, i.e., with the </span>
<span class="sd">        combined results of the run.</span>

<span class="sd">    dsc_file_path: ``str``</span>
<span class="sd">        Full path to the file containing the results of the delta sigma cut.</span>

<span class="sd">    plot_dir: ``str``</span>
<span class="sd">        Full path where the plots generated by the statistical checks module should be saved.</span>
<span class="sd">    param_file: ``str``</span>
<span class="sd">        Full path to the parameter file that was used for the analysis.</span>
<span class="sd">    coherence_far: ``float``</span>
<span class="sd">        Coherence false alarm rate</span>
<span class="sd">    legend_fontsize: ``int``, optional</span>
<span class="sd">        Fontsize used in the plots generated by the module. Defaults to 16.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    pygwb.notch.StochNotchList</span>

<span class="sd">    pygwb.parameters.Parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
    <span class="n">params</span><span class="o">.</span><span class="n">update_from_file</span><span class="p">(</span><span class="n">param_file</span><span class="p">)</span>
    <span class="n">spectra_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">combine_file_path</span><span class="p">)</span>
    <span class="n">dsc_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dsc_file_path</span><span class="p">)</span>

    <span class="n">badGPStimes</span> <span class="o">=</span> <span class="n">dsc_file</span><span class="p">[</span><span class="s2">&quot;badGPStimes&quot;</span><span class="p">]</span>
    <span class="n">delta_sigmas</span> <span class="o">=</span> <span class="n">dsc_file</span><span class="p">[</span><span class="s2">&quot;delta_sigma_values&quot;</span><span class="p">]</span>
    <span class="n">sliding_times</span> <span class="o">=</span> <span class="n">dsc_file</span><span class="p">[</span><span class="s2">&quot;delta_sigma_times&quot;</span><span class="p">]</span>
    <span class="n">naive_sigma_all</span> <span class="o">=</span> <span class="n">dsc_file</span><span class="p">[</span><span class="s2">&quot;naive_sigma_values&quot;</span><span class="p">]</span>
    <span class="n">gates_ifo1</span> <span class="o">=</span> <span class="n">dsc_file</span><span class="p">[</span><span class="s2">&quot;ifo_1_gates&quot;</span><span class="p">]</span>
    <span class="n">gates_ifo2</span> <span class="o">=</span> <span class="n">dsc_file</span><span class="p">[</span><span class="s2">&quot;ifo_2_gates&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">gates_ifo1</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">gates_ifo1</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">if</span> <span class="n">gates_ifo2</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">gates_ifo2</span><span class="o">=</span><span class="kc">None</span>

    <span class="n">sliding_omega_all</span><span class="p">,</span> <span class="n">sliding_sigmas_all</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">spectra_file</span><span class="p">[</span><span class="s2">&quot;point_estimates_seg_UW&quot;</span><span class="p">],</span>
        <span class="n">spectra_file</span><span class="p">[</span><span class="s2">&quot;sigmas_seg_UW&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">params</span><span class="o">.</span><span class="n">new_sample_rate</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">params</span><span class="o">.</span><span class="n">frequency_resolution</span><span class="p">,</span>
        <span class="n">params</span><span class="o">.</span><span class="n">frequency_resolution</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">frequency_cut</span> <span class="o">=</span> <span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">fhigh</span> <span class="o">&gt;=</span> <span class="n">frequencies</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">frequencies</span> <span class="o">&gt;=</span> <span class="n">params</span><span class="o">.</span><span class="n">flow</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">frequency_mask</span> <span class="o">=</span> <span class="n">spectra_file</span><span class="p">[</span><span class="s2">&quot;frequency_mask&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">notch_list_path</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">notch_list_path</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;loading notches from &quot;</span> <span class="o">+</span> <span class="n">notch_list_path</span><span class="p">)</span>
            <span class="n">notch_list</span> <span class="o">=</span> <span class="n">StochNotchList</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="n">notch_list_path</span><span class="p">)</span>
            <span class="n">frequency_mask</span> <span class="o">=</span> <span class="n">notch_list</span><span class="o">.</span><span class="n">get_notch_mask</span><span class="p">(</span><span class="n">frequencies</span><span class="p">[</span><span class="n">frequency_cut</span><span class="p">])</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="n">frequency_mask</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">spectrum_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">combine_file_path</span><span class="p">,</span> <span class="n">mmap_mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="n">point_estimate_spectrum</span> <span class="o">=</span> <span class="n">spectrum_file</span><span class="p">[</span><span class="s2">&quot;point_estimate_spectrum&quot;</span><span class="p">]</span>
    <span class="n">sigma_spectrum</span> <span class="o">=</span> <span class="n">spectrum_file</span><span class="p">[</span><span class="s2">&quot;sigma_spectrum&quot;</span><span class="p">]</span>

    <span class="n">baseline_name</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">interferometer_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="o">.</span><span class="n">interferometer_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># select alpha for statistical checks</span>
    <span class="n">delta_sigmas_sel</span> <span class="o">=</span> <span class="n">delta_sigmas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">naive_sigmas_sel</span> <span class="o">=</span> <span class="n">naive_sigma_all</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">coherence_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">coh_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">coherence_file_path</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">coherence_spectrum</span> <span class="o">=</span> <span class="n">coh_data</span><span class="p">[</span><span class="s1">&#39;coherence&#39;</span><span class="p">]</span>
        <span class="n">coherence_n_segs</span> <span class="o">=</span> <span class="n">coh_data</span><span class="p">[</span><span class="s1">&#39;n_segs_coh&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coherence_spectrum</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">coherence_n_segs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">StatisticalChecks</span><span class="p">(</span>
        <span class="n">sliding_times</span><span class="p">,</span>
        <span class="n">sliding_omega_all</span><span class="p">,</span>
        <span class="n">sliding_sigmas_all</span><span class="p">,</span>
        <span class="n">naive_sigmas_sel</span><span class="p">,</span>
        <span class="n">coherence_spectrum</span><span class="p">,</span>
        <span class="n">coherence_n_segs</span><span class="p">,</span>
        <span class="n">point_estimate_spectrum</span><span class="p">,</span>
        <span class="n">sigma_spectrum</span><span class="p">,</span>
        <span class="n">frequencies</span><span class="p">[</span><span class="n">frequency_cut</span><span class="p">],</span>
        <span class="n">badGPStimes</span><span class="p">,</span>
        <span class="n">delta_sigmas_sel</span><span class="p">,</span>
        <span class="n">plot_dir</span><span class="p">,</span>
        <span class="n">baseline_name</span><span class="p">,</span>
        <span class="n">param_file</span><span class="p">,</span>
        <span class="n">frequency_mask</span><span class="p">,</span>
        <span class="n">coherence_far</span><span class="p">,</span>
        <span class="n">gates_ifo1</span><span class="p">,</span>
        <span class="n">gates_ifo2</span><span class="p">,</span>
        <span class="n">file_tag</span><span class="o">=</span><span class="n">file_tag</span><span class="p">,</span>
        <span class="n">legend_fontsize</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span>
        <span class="n">convention</span><span class="o">=</span><span class="n">convention</span><span class="p">,</span>
        <span class="n">seaborn_palette</span><span class="o">=</span><span class="n">seaborn_palette</span><span class="p">,</span>
    <span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Arianna Renzini, Sylvia Biscoveanu, Shivaraj Khandasamy, Kamiel Janssens, Max Lalleman, Katarina Martinovic, Andrew Matas, Patrick Meyers, Alba Romero, Colm Talbot, Leo Tsukada, Kevin Turbang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>