<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygwb.postprocessing &mdash; pygwb 1.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=0264ad83"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf" href="pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf.html" />
    <link rel="prev" title="pygwb.coherence.calculate_coherence" href="pygwb.coherence.calculate_coherence.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/pygwb_logo_plasma_cropped.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About <code class="docutils literal notranslate"><span class="pre">pygwb</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos.html">Demos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pygwb.detector.html">pygwb.detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.baseline.html">pygwb.baseline</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.network.html">pygwb.network</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.preprocessing.html">pygwb.preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.spectral.html">pygwb.spectral</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.coherence.html">pygwb.coherence</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pygwb.postprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf.html">pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygwb.postprocessing.calculate_point_estimate_sigma_spectra.html">pygwb.postprocessing.calculate_point_estimate_sigma_spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygwb.postprocessing.combine_spectra_with_sigma_weights.html">pygwb.postprocessing.combine_spectra_with_sigma_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygwb.postprocessing.odd_even_segment_postprocessing.html">pygwb.postprocessing.odd_even_segment_postprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygwb.postprocessing.postprocess_Y_sigma.html">pygwb.postprocessing.postprocess_Y_sigma</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.omega_spectra.html">pygwb.omega_spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.pe.html">pygwb.pe</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.statistical_checks.html">pygwb.statistical_checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.simulator.html">pygwb.simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.delta_sigma_cut.html">pygwb.delta_sigma_cut</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.notch.html">pygwb.notch</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.constants.html">pygwb.constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.orfs.html">pygwb.orfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.parameters.html">pygwb.parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygwb.util.html">pygwb.util</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://arxiv.org/pdf/2303.15696.pdf">pygwb paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing <code class="docutils literal notranslate"><span class="pre">pygwb</span></code></a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/a-renzini/pygwb">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/a-renzini/pygwb/issues/new">Submit an issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pygwb</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API</a></li>
      <li class="breadcrumb-item active">pygwb.postprocessing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/pygwb.postprocessing.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pygwb.postprocessing">
<span id="pygwb-postprocessing"></span><h1>pygwb.postprocessing<a class="headerlink" href="#module-pygwb.postprocessing" title="Permalink to this heading"></a></h1>
<p>The postprocessing module combines all methods which are useful in the end stages of the analysis,
more specifically when combining spectrograms into spectra, and spectra into one overall point estimate for the gravitational-wave background.</p>
<p>This module contains methods such as <code class="docutils literal notranslate"><span class="pre">postprocess_Y_sigma</span></code>, which combines point estimate and sigma spectrograms
into spectra using a method where odd and even segments are treated differently if the data are overlapping.
To account for the overlap, it uses another function of the postprocessing module, <code class="docutils literal notranslate"><span class="pre">odd_even_segment_postprocessing</span></code>.
Additional information about this procedure can be found <a class="reference external" href="https://arxiv.org/pdf/2303.15696.pdf">here</a>.</p>
<p>These spectrograms are computed from the cross spectral density (CSD) and the power spectral density (PSD).
The postprocessing module also contains the method which takes care of the above, namely
<code class="docutils literal notranslate"><span class="pre">calculate_point_estimate_sigma_spectra</span></code>.
Starting from a set of CSD and PSD spectrograms, one can compute the point estimate and sigma spectrograms,
objects that contain both frequency and segment data information.
Then, the spectrograms are combined into spectra with these methods.
These spectra then have to be combined into one single point estimate and its variance, which is achieved by calling <code class="docutils literal notranslate"><span class="pre">calc_Y_sigma_from_Yf_sigmaf</span></code>.</p>
<p class="rubric">Examples</p>
<p>Starting from averaged PSDs and the CSD of a baseline,
we can compute the overall point estimate for the gravitational-wave background.</p>
<p>Assuming we already computed the CSDs and PSDs, see for example in <a class="reference internal" href="pygwb.spectral.html"><span class="doc">pygwb.spectral</span></a>,
we also need the overlap reduction function, see <a class="reference internal" href="pygwb.orfs.html"><span class="doc">pygwb.orfs</span></a>.
With these at hand, we can compute the point estimate spectrogram
and its variance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Y_spectrogram</span><span class="p">,</span> <span class="n">var_spectrogram</span> <span class="o">=</span> <span class="n">calculate_point_estimate_sigma_spectra</span><span class="p">(</span>
<span class="go">        CSD_baseline.frequencies.value,</span>
<span class="go">        CSD_baseline[2:-2],</span>
<span class="go">        ifo_1.average_psd.crop_frequencies(3.12500000e-02,2.048e+03),</span>
<span class="go">        ifo_2.average_psd.crop_frequencies(3.12500000e-02,2.048e+03),</span>
<span class="go">        orf,</span>
<span class="go">        sample_rate=4096,</span>
<span class="go">        segment_duration=192,</span>
<span class="go">        window_fftgram_dict={&quot;window_fftgram&quot;: &quot;hann&quot;},</span>
<span class="go">        overlap_factor=0.5,</span>
<span class="go">        fref=25.0,</span>
<span class="go">        alpha=0.0,</span>
<span class="go">    )</span>
</pre></div>
</div>
<p>For this example, we used some pre-computed CSD and PSDs, for some baseline, together with its overlap reduction function.
The above returns the point estimate and variance as a function of frequency and time, i.e., for each segment.
These can be combined over all analysis segments into a single point estimate and sigma spectrum, i.e. as a function of frequency only.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Y_spectrum</span><span class="p">,</span> <span class="n">var_spectrum</span> <span class="o">=</span> <span class="n">postprocess_Y_sigma</span><span class="p">(</span>
<span class="go">        Y_spectrogram.value,</span>
<span class="go">        var_spectrogram.value,</span>
<span class="go">        segment_duration=192,</span>
<span class="go">        deltaF=1/32.,</span>
<span class="go">        new_sample_rate=4096,</span>
<span class="go">        frequency_mask=True,</span>
<span class="go">        badtimes_mask=None,</span>
<span class="go">        window_fftgram_dict={&quot;window_fftgram&quot;: &quot;hann&quot;},</span>
<span class="go">        window_fftgram_dict_welch={&quot;window_fftgram&quot;: &quot;hann&quot;},</span>
<span class="go">        overlap_factor=0.5,</span>
<span class="go">        overlap_factor_welch=0.5,</span>
<span class="go">        N_avg_segs=2,</span>
<span class="go">    )</span>
</pre></div>
</div>
<p>To compute a single point estimate and its variance for the magnitude of the GWB, one uses the frequency
spectra computed above and relies on the following method:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">postpp</span><span class="o">.</span><span class="n">calc_Y_sigma_from_Yf_sigmaf</span><span class="p">(</span>
<span class="go">        Y_spectrum, np.sqrt(var_spectrum), frequency_mask=True, alpha=None, fref=None</span>
<span class="go">    )</span>
</pre></div>
</div>
<p>The result is an overall point estimate and standard deviation. Additional information on the various methods outlined above
can be found in the following dedicated API documentation of the module.</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf.html#pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf" title="pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_Y_sigma_from_Yf_sigmaf</span></code></a>(Y_f, sigma_f[, ...])</p></td>
<td><p>Calculate the omega point estimate and sigma from their respective spectra, or spectrograms, taking into account the desired spectral weighting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pygwb.postprocessing.calculate_point_estimate_sigma_spectra.html#pygwb.postprocessing.calculate_point_estimate_sigma_spectra" title="pygwb.postprocessing.calculate_point_estimate_sigma_spectra"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_point_estimate_sigma_spectra</span></code></a>(...)</p></td>
<td><p>Calculate the Omega point estimate and associated sigma integrand, given a set of cross-spectral and power-spectral density spectrograms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pygwb.postprocessing.combine_spectra_with_sigma_weights.html#pygwb.postprocessing.combine_spectra_with_sigma_weights" title="pygwb.postprocessing.combine_spectra_with_sigma_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">combine_spectra_with_sigma_weights</span></code></a>(...)</p></td>
<td><p>Combine different statistically independent spectra <span class="math notranslate nohighlight">\(S_i(f)\)</span> using spectral weights <span class="math notranslate nohighlight">\(w_i(f)\)</span>, as</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pygwb.postprocessing.odd_even_segment_postprocessing.html#pygwb.postprocessing.odd_even_segment_postprocessing" title="pygwb.postprocessing.odd_even_segment_postprocessing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">odd_even_segment_postprocessing</span></code></a>(Y_fs, ...[, ...])</p></td>
<td><p>Perform averaging which combines even and odd segments for overlapping data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pygwb.postprocessing.postprocess_Y_sigma.html#pygwb.postprocessing.postprocess_Y_sigma" title="pygwb.postprocessing.postprocess_Y_sigma"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postprocess_Y_sigma</span></code></a>(Y_fs, var_fs, ...[, ...])</p></td>
<td><p>Run postprocessing of point estimate and sigma spectrograms, combining even and odd segments in the case of overlapping data.</p></td>
</tr>
</tbody>
</table>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pygwb.coherence.calculate_coherence.html" class="btn btn-neutral float-left" title="pygwb.coherence.calculate_coherence" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf.html" class="btn btn-neutral float-right" title="pygwb.postprocessing.calc_Y_sigma_from_Yf_sigmaf" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Arianna Renzini, Sylvia Biscoveanu, Shivaraj Khandasamy, Kamiel Janssens, Max Lalleman, Katarina Martinovic, Andrew Matas, Patrick Meyers, Alba Romero, Colm Talbot, Leo Tsukada, Kevin Turbang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>