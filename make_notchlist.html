<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate a notch list &mdash; pygwb 1.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=0264ad83"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Calculate overlap reduction functions" href="test_orfs.html" />
    <link rel="prev" title="Parameter estimation demo: customizing runs" href="run_pe.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/pygwb_logo_plasma_cropped.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About <code class="docutils literal notranslate"><span class="pre">pygwb</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="demos.html">Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="run_pe.html">Parameter estimation demo: customizing runs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Generate a notch list</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Background-information-about-the-different-lines-that-should-be-notched">Background information about the different lines that should be notched</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creation-of-an-example-notch-list">Creation of an example notch list</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Applying-a-notch-list">Applying a notch list</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="test_orfs.html">Calculate overlap reduction functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_statistical_checks.html">Interpret the output of the <code class="docutils literal notranslate"><span class="pre">statistical_checks</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arxiv.org/pdf/2303.15696.pdf">pygwb paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing <code class="docutils literal notranslate"><span class="pre">pygwb</span></code></a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/a-renzini/pygwb">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/a-renzini/pygwb/issues/new">Submit an issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pygwb</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="demos.html">Demos</a></li>
      <li class="breadcrumb-item active">Generate a notch list</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/make_notchlist.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Generate-a-notch-list">
<h1>Generate a notch list<a class="headerlink" href="#Generate-a-notch-list" title="Permalink to this heading"></a></h1>
<p>Reaslistic detector data will contain noise lines, that should be omitted from the analysis. The procedure of masking out frequencies is called <em>notching</em>. This notebook is meant as a tutorial on how to perform these frequency notches by creating a <code class="docutils literal notranslate"><span class="pre">StochNotchList</span></code> object from the <code class="docutils literal notranslate"><span class="pre">notch</span></code> module within <code class="docutils literal notranslate"><span class="pre">pygwb</span></code>. More information about the <code class="docutils literal notranslate"><span class="pre">notch</span></code> module can be found on the <a class="reference external" href="api/pygwb.notch.html">documentation page</a>.</p>
<section id="Background-information-about-the-different-lines-that-should-be-notched">
<h2>Background information about the different lines that should be notched<a class="headerlink" href="#Background-information-about-the-different-lines-that-should-be-notched" title="Permalink to this heading"></a></h2>
<p><strong>Calibration lines</strong> - At specific frequencies, lines are inserted by moving the mirrors to use this information to calibrate the data. Calibration lines are specififc to each detector and should be notched in the baselines containing those detectors.</p>
<p><strong>Power lines</strong> - Typically there are strong lines present at the frequency of the power mains. Power mains lines are at 60Hz and harmonics for the US power grid (LIGO) and at 50Hz and harmonics for the Italian power grid (Virgo). They should be notched in the baselines containing those detectors.</p>
<p><strong>Violin modes</strong> - Violin modes are the thermally excited resonances of the mirror suspensions. Violin modes are detector specific and the violin modes of each detector should be notched in the baselines containing those detectors.</p>
<p><strong>Pulsar injections</strong> - These are narrowband signals injected to validate pipelines searching for continous waves from e.g. pulsars. The injections are the same in the different detectors and should be notched.</p>
<p><strong>Environmental/instrumental lines and baseline specific lines</strong> - Wheareas all the previous classes of lines are by default known, there are many lines caused by the local environment and/or instruments, such as a 1 Hz comb due to GPS synchronistation. Environmental/instrumental lines are typically only notched in stochastic searches when they show up coherently in a time-shifted or non time-shifted analysis, and their source is identified to be of environmental/instrumental origin. In that
scenario, the line is notched for the baseline that is affected. If all (un)known experimental/instrumental for each detector were to be subtracted, this would lead to a significant loss of frequencies to analyse, even if they didn’t affect the search for a gravitational-wave background since they aren’t coherent between the different detectors.</p>
<p>Additional information about noise lines can be found <a class="reference external" href="https://arxiv.org/pdf/2210.00761.pdf">here</a>.</p>
</section>
<section id="Creation-of-an-example-notch-list">
<h2>Creation of an example notch list<a class="headerlink" href="#Creation-of-an-example-notch-list" title="Permalink to this heading"></a></h2>
<p>In this tutorial, we will create a <code class="docutils literal notranslate"><span class="pre">StochNotchList</span></code> object that can be used in <code class="docutils literal notranslate"><span class="pre">pygwb</span></code> to apply a notch mask to the analysis. The <code class="docutils literal notranslate"><span class="pre">notch</span></code> module assumes one already knows which lines should be notched, and is not a tool to identify frequency lines to be notched. If this is not the case, one should first use other tools to understand which frequencies should be notched.</p>
<p>In this tutorial, we will consider the three detectors LIGO Hanford (H1), LIGO Livingston (L1), and Virgo (V1). We create three different notch lists, one for each baseline, i.e., HL, HV and LV. We assume the following lines are present:</p>
<ul class="simple">
<li><p>H1: calibration line from 16.6Hz to 17.6Hz</p></li>
<li><p>L1: calibration line from 434.4 to 435.4</p></li>
<li><p>V1: calibration line from 16.9Hz to 17.1Hz</p></li>
<li><p>H1, L1: powerlines at 60Hz and harmonics</p></li>
<li><p>V1: powerlines at 50Hz and harmonics</p></li>
<li><p>All baselines : pulsar injections (see data file in input)</p></li>
<li><p>HV-baseline: a comb of lines at 1Hz and multiples (up to 500Hz), width of 0.01 Hz.</p></li>
</ul>
<p><em>Note: Only lines up to 2024Hz will be considered.</em></p>
<p><em>Disclaimer: The examples used here are for illustrative purpose and shouldn’t be considered as a realistic scenario, although realistic examples are given.</em></p>
<p>We start by importing some packages needed for the execution of the tutorial:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pygwb</span> <span class="kn">import</span> <span class="n">notch</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">my_palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;colorblind&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><em>Note: make sure to run this notebook within an environment that has all the above packages installed.</em></p>
<p>We now create three separate notch lists using the <code class="docutils literal notranslate"><span class="pre">StochNotchList</span></code> method from the <code class="docutils literal notranslate"><span class="pre">notch</span></code> module. As a helper function to create the notches for the calibration lines, we define the <code class="docutils literal notranslate"><span class="pre">calibration_lines</span></code> in this notebook:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calibration_lines</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
    <span class="n">notches</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">StochNotchList</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">det</span> <span class="o">==</span> <span class="s2">&quot;H1&quot;</span><span class="p">:</span>
        <span class="n">notches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">notch</span><span class="o">.</span><span class="n">StochNotch</span><span class="p">(</span><span class="mf">16.6</span><span class="p">,</span> <span class="mf">17.6</span><span class="p">,</span> <span class="s2">&quot;H1 calibration line&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">det</span> <span class="o">==</span> <span class="s2">&quot;L1&quot;</span><span class="p">:</span>
        <span class="n">notches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">notch</span><span class="o">.</span><span class="n">StochNotch</span><span class="p">(</span><span class="mf">434.4</span><span class="p">,</span> <span class="mf">435.4</span><span class="p">,</span> <span class="s2">&quot;L1 calibration line&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">det</span> <span class="o">==</span> <span class="s2">&quot;V1&quot;</span><span class="p">:</span>
        <span class="n">notches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">notch</span><span class="o">.</span><span class="n">StochNotch</span><span class="p">(</span><span class="mf">16.9</span><span class="p">,</span> <span class="mf">17.1</span><span class="p">,</span> <span class="s2">&quot;V1 calibration line&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">notches</span>
</pre></div>
</div>
</div>
<p>For more information about the <code class="docutils literal notranslate"><span class="pre">StochNotch</span></code> object, see <a class="reference external" href="api/pygwb.notch.html">this</a> documentation page.</p>
<p>In this tutorial, we consider the various notches as mentioned at the start of the tutorial (note that this is just purely for illustrative purposes):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_power_lines_60</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">power_lines</span><span class="p">(</span><span class="n">nharmonics</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">2024.</span><span class="o">/</span><span class="mf">60.</span><span class="p">))</span>
<span class="n">noise_power_lines_50</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">power_lines</span><span class="p">(</span><span class="n">fundamental</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nharmonics</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">2024.</span><span class="o">/</span><span class="mf">50.</span><span class="p">))</span>
<span class="n">noise_calibration_lines_H1</span> <span class="o">=</span> <span class="n">calibration_lines</span><span class="p">(</span><span class="n">det</span><span class="o">=</span><span class="s2">&quot;H1&quot;</span><span class="p">)</span>
<span class="n">noise_calibration_lines_L1</span> <span class="o">=</span> <span class="n">calibration_lines</span><span class="p">(</span><span class="n">det</span><span class="o">=</span><span class="s2">&quot;L1&quot;</span><span class="p">)</span>
<span class="n">noise_calibration_lines_V1</span> <span class="o">=</span> <span class="n">calibration_lines</span><span class="p">(</span><span class="n">det</span><span class="o">=</span><span class="s2">&quot;V1&quot;</span><span class="p">)</span>
<span class="n">noise_pulsar_injections</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">pulsar_injections</span><span class="p">(</span><span class="s2">&quot;input/Toy_example_pulsars.dat&quot;</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="mi">1238112018</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">1269363618</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>These notches can now be added to a <code class="docutils literal notranslate"><span class="pre">StochNotchList</span></code>, where such a list is created for each of the baselines (HL,HV, and LV) to account for the correct notches (including notches specific to a single detector of the baseline):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_lines_HL</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">StochNotchList</span><span class="p">([])</span>
<span class="n">noise_lines_HL</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_power_lines_60</span><span class="p">)</span>
<span class="n">noise_lines_HL</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_calibration_lines_H1</span><span class="p">)</span>
<span class="n">noise_lines_HL</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_calibration_lines_L1</span><span class="p">)</span>
<span class="n">noise_lines_HL</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_pulsar_injections</span><span class="p">)</span>

<span class="n">noise_lines_HV</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">StochNotchList</span><span class="p">([])</span>
<span class="n">noise_lines_HV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_power_lines_60</span><span class="p">)</span>
<span class="n">noise_lines_HV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_power_lines_50</span><span class="p">)</span>
<span class="n">noise_lines_HV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_calibration_lines_H1</span><span class="p">)</span>
<span class="n">noise_lines_HV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_calibration_lines_V1</span><span class="p">)</span>
<span class="n">noise_lines_HV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_pulsar_injections</span><span class="p">)</span>
<span class="n">noise_lines_HV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">notch</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">))</span>

<span class="n">noise_lines_LV</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">StochNotchList</span><span class="p">([])</span>
<span class="n">noise_lines_LV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_power_lines_60</span><span class="p">)</span>
<span class="n">noise_lines_LV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_power_lines_50</span><span class="p">)</span>
<span class="n">noise_lines_LV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_calibration_lines_L1</span><span class="p">)</span>
<span class="n">noise_lines_LV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_calibration_lines_V1</span><span class="p">)</span>
<span class="n">noise_lines_LV</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">noise_pulsar_injections</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For future use, one can save the notch lists to file, using the dedicated <code class="docutils literal notranslate"><span class="pre">save_to_txt</span></code> method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_lines_HL</span><span class="o">.</span><span class="n">save_to_txt</span><span class="p">(</span><span class="s1">&#39;output/Toy_example_HL_notchlist.txt&#39;</span><span class="p">)</span>
<span class="n">noise_lines_HV</span><span class="o">.</span><span class="n">save_to_txt</span><span class="p">(</span><span class="s1">&#39;output/Toy_example_HV_notchlist.txt&#39;</span><span class="p">)</span>
<span class="n">noise_lines_LV</span><span class="o">.</span><span class="n">save_to_txt</span><span class="p">(</span><span class="s1">&#39;output/Toy_example_LV_notchlist.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For more information about the <code class="docutils literal notranslate"><span class="pre">save_to_txt</span></code> method, see the API documentation <a class="reference external" href="api/pygwb.notch.StochNotchList.html#pygwb.notch.StochNotchList.save_to_txt">here</a>.</p>
</section>
<section id="Applying-a-notch-list">
<h2>Applying a notch list<a class="headerlink" href="#Applying-a-notch-list" title="Permalink to this heading"></a></h2>
<p>For the remainder of the tutorial, we focus on the HL baseline and illustrate how a notch list can be applied to a data set. However, the notch list can be applied to different baselines in an analogous way. Furthermore, although we can just use the notchlist defined earlier in this notebook, we will read in the notch list from its saved txt file to demonstrate this functionality (using the <code class="docutils literal notranslate"><span class="pre">load_from_file</span></code> method, more details
<a class="reference external" href="api/pygwb.notch.StochNotchList.html#pygwb.notch.StochNotchList.load_from_file">here</a>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HL_notch_list</span> <span class="o">=</span> <span class="n">notch</span><span class="o">.</span><span class="n">StochNotchList</span><span class="p">([])</span>
<span class="n">HL_notch_list</span> <span class="o">=</span> <span class="n">HL_notch_list</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="s1">&#39;output/Toy_example_HL_notchlist.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For the sake of the tutorial, we will use the aLIGO design sensitivity curve as our data, which can be downloaded from <a class="reference external" href="https://dcc.ligo.org/LIGO-T1800044/public">here</a>. For simplicity, this file is also included in the ‘input’ directory (v5 of the file, to be precise). We now read in this data set:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frequencies_tmp</span> <span class="p">,</span><span class="n">data_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;input/aLIGOdesign.txt&#39;</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We choose to only perfrom our analysis in the frequency region from 20Hz to 1012Hz with a 1/32 Hz (0.03125 Hz) resolution. We therefore perform an interpolation of the data that was just read in, to have the correct frequencies.</p>
<p><em>Note: we strongly advise to always use powers of two as bin width, otherwise the frequencies might not be represented exactly due to non-exact representation in binary.</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1012</span><span class="p">,</span> <span class="mf">0.03125</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">frequencies_tmp</span><span class="p">,</span> <span class="n">data_tmp</span><span class="p">)[:</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<p>To obtain the frequency mask from the notch list, we use the <code class="docutils literal notranslate"><span class="pre">get_notch_mask</span></code> method (see <a class="reference external" href="api/pygwb.notch.StochNotchList.html#pygwb.notch.StochNotchList.get_notch_mask">here</a>), and apply it to the data, simply with a multiplication:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HL_notch_mask</span> <span class="o">=</span> <span class="n">HL_notch_list</span><span class="o">.</span><span class="n">get_notch_mask</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="n">data_notched</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">HL_notch_mask</span>
</pre></div>
</div>
</div>
<p>We now plot the data before and after applying the notches:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;aLIGO design sensitivity&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">my_palette</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="n">data_notched</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;aLIGO design sensitivity - notched&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">my_palette</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">1012</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-24</span><span class="p">,</span><span class="mf">1e-22</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/make_notchlist_31_0.png" src="_images/make_notchlist_31_0.png" />
</div>
</div>
<p>The above plot shows that the frequenies contained in the notch list have been “zeroed” out, i.e. notched.</p>
<p>As a final step, one could decide to save the actual frequency mask (note not the notch list) to file by using the <code class="docutils literal notranslate"><span class="pre">save_notch_mask</span></code> method (see <a class="reference external" href="api/pygwb.notch.StochNotchList.html#pygwb.notch.StochNotchList.save_notch_mask">here</a> for more information):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HL_notch_list</span><span class="o">.</span><span class="n">save_notch_mask</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="s1">&#39;./output/notch_mask_Toy_example_HL.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="run_pe.html" class="btn btn-neutral float-left" title="Parameter estimation demo: customizing runs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="test_orfs.html" class="btn btn-neutral float-right" title="Calculate overlap reduction functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Arianna Renzini, Sylvia Biscoveanu, Shivaraj Khandasamy, Kamiel Janssens, Max Lalleman, Katarina Martinovic, Andrew Matas, Patrick Meyers, Alba Romero, Colm Talbot, Leo Tsukada, Kevin Turbang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>